# Railway Database Configuration - Use Railway's auto-generated variables
spring.datasource.url=${SPRING_DATASOURCE_URL}
spring.datasource.username=${SPRING_DATASOURCE_USERNAME}
spring.datasource.password=${SPRING_DATASOURCE_PASSWORD}
spring.datasource.driver-class-name=com.mysql.cj.jdbc.Driver
spring.jpa.hibernate.ddl-auto=none
spring.jpa.database-platform=org.hibernate.dialect.MySQLDialect
spring.sql.init.mode=always
spring.jpa.show-sql=true

# Server Configuration - Railway sets PORT automatically, with local fallback
server.port=${PORT:8081}

# Google OAuth Configuration
spring.security.oauth2.client.registration.google.client-id=${GOOGLE_CLIENT_ID}
spring.security.oauth2.client.registration.google.client-secret=${GOOGLE_CLIENT_SECRET}
spring.security.oauth2.client.registration.google.scope=openid,email,profile
spring.security.oauth2.client.registration.google.authorization-grant-type=authorization_code

# Logging Configuration
logging.level.site.easy.to.build.crm.controller=DEBUG
logging.level.org.springframework.web=DEBUG
logging.level.org.springframework.security=DEBUG
logging.level.org.thymeleaf=DEBUG
logging.level.org.thymeleaf.TemplateEngine=DEBUG
logging.level.org.springframework.web.servlet.view.ContentNegotiatingViewResolver=DEBUG

# Weather API Configuration
weather.api.url=http://api.weatherapi.com/v1/current.json
weather.api.key=${WEATHER_API_KEY}

# PayProp API Configuration
payprop.api.base-url=https://uk.payprop.com/api/agency/v1.1
payprop.api.key=${PAYPROP_API_KEY:YOUR_ACTUAL_API_KEY_HERE}

# PayProp Webhook Configuration - Dynamic base URL
payprop.webhook.enabled=true
payprop.webhook.base-url=${APP_BASE_URL:http://localhost:8081}/api/payprop/webhook
payprop.webhook.verify-signature=true
payprop.webhook.secret=${PAYPROP_WEBHOOK_SECRET:your-webhook-secret}

# Portfolio Configuration
portfolio.auto-sync.enabled=true
portfolio.auto-sync.interval=3600000
portfolio.analytics.calculation-schedule=0 0 2 * * ?

# PayProp Two-Way Sync Settings
payprop.sync.pull-tags-on-startup=false
payprop.sync.auto-create-portfolios=true
payprop.sync.conflict-resolution=MANUAL

# More detailed OAuth logging
logging.level.org.springframework.security.oauth2=DEBUG
logging.level.org.springframework.security.oauth2.client=DEBUG
logging.level.org.springframework.security.web.authentication=DEBUG

# Prevent app crash on errors
server.error.whitelabel.enabled=true
server.error.include-stacktrace=always

# Application Base URL - Dynamic for Railway
app.base-url=${APP_BASE_URL:http://localhost:8081/}
company.name=${COMPANY_NAME}

# Database Connection Pool Settings (to prevent timeouts)
spring.datasource.hikari.connection-timeout=30000
spring.datasource.hikari.maximum-pool-size=5
spring.datasource.hikari.minimum-idle=2